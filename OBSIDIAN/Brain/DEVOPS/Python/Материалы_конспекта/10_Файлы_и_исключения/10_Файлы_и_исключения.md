[Назад](Конспект_Python.md)
___
* [[#- Чтение всего файла -]]
* [[#- Сохраняем содержимое файлы в список -]]
* [[#- Работа с содержимим файла -]]
* [[#- Большие файлы миллион цифр -]]
* [[#- replace() - замена слова в строке другим словом -]]
* [[#- Сопоставляем ДР числу ПИ -]]
* [[#- Сохранение и чтение данных, сгенериованных пользователем -]]
* [[#- Программа загружает имя пользователя, если оно было сохранено раннее. В противном случае она записывает имя пользователя и сохраняет его. -]]
* [[#- Рефакторинг - запаковываем код в функцию -]]
* [[#- ИСКЛЮЧЕНИЯ try-except -]]
* [[#- анализ Текста, подсчет слов -]]
* [[#- Ошибка без уведомления -]]

#### - Чтение всего файла -

>  Функции json.dump() и json.load()
>  Используется для сохранения и выгрузки из файла .json
>  Файл должен лежать в текущей дериктории.

```python

# with open(file_path) as file_object:
with open('pi_digits.txt') as file_object:# open() - открываем наш файл
# with - закроет файл когда надобность пропадет
    contents = file_object.read()  # read - забираем содержимое файла и #сохраняем в строке
print(contents.rstrip())   # rstrip - удалит пустую строку в конце вывода

#-----------------------------------------------------------------------------#

print("\n")
filename = 'pi_digits.txt'
with open(filename) as file_object:
    for line in file_object:
        print(line.rstrip())
```

> Можно указать абсолютный путь к файлу.

```python
# передать абсолютный путь к файлу
 file_path = '/home/lex/file/pi_digits.txt' 
```

#### - Сохраняем содержимое файлы в список -

```python
print("\n")
filename = 'pi_digits.txt'

with open(filename) as file_object:
# readlines() - каждую строку файла  сохранит в список
    lines = file_object.readlines() # список сохраняем в переменную line
for line in lines:
    print(line.rstrip())# rstrip - удалит пустую строку в конце вывода
```

#### - Работа с содержимым файла -

>Весть текст в файле - это строки. Если нужно работать с числами
>необходимо преобразование методом int() или float()

```python
print("\nРабота с содержимим файла")
filename = 'pi_digits.txt'

with open(filename) as file_object:
# readlines() - каждую строку файла сохранит в список
    lines = file_object.readlines() 
                                    # список сохраняем в переменную line
pi_string = ''                 # создаем переменную для хранения цифр 
for line in lines:             # записываем каждую серию цифр в pi_string 
    pi_string += line.strip() # и удаляем пропуски

print(pi_string)  
print(len(pi_string)) # Выводим количество символов
```

#### - Большие файлы: миллион цифр -

```python
filename = 'pi_million_digits.txt'
print("\nМиллион знаков")
with open(filename) as file_object:
    lines = file_object.readlines()
pi_string = ''
for line in lines:
    pi_string += line.strip()

print(f"{pi_string[0:52]}...") # выводим первые 52 знака
print(len(pi_string)) # Выводим количество символов
```

#### - replace() - замена слова в строке другим словом -

```python
filename = 'pi_replace.txt'

with open(filename) as file_object:
    lines = file_object.readlines()
worlds = ''
for line in lines:
    worlds += line.strip()
    world_rep = worlds.replace('C', 'Python')
print(f"\nДоступные языки програмирования {worlds}")
print(f"\nВаш выбор {world_rep} ?")
```

#### - Сопоставляем ДР числу ПИ -

```python
filename = 'pi_million_digits.txt'

with open(filename) as file_object:
    lines = file_object.readlines()
pi_string = ''
for line in lines:
    pi_string += line.strip()

birthday = input("Введите дату рождения (mmddyy):")
if birthday in pi_string:
    print("Дата вашего Дня Рождения входит в первые миллион цифр числа ПИ.")
else:
    print("Дата вашего Дня Рождения НЕ входит в первые миллион цифр числа ПИ.")
```

#### - Сохранение и чтение данных, сгенериованных пользователем -

>Можно сохранить только строки в файл, для чисел нужно  воспользоваться
> методом str() для приобразования


```python

# Открываем фаил в режиме чтения-записи
# w-запись, r-чтение, a-чтение и запись 
# r+ - чтение и запись в файл
# write - метод записи строки в файл
username = input("Имя: ")

filename = 'username.json'
with open(filename, 'w') as f:
    json.dump(username, f)
    print(f"Имя {username} успешно сохранено в json файл")


filename = 'username.json'
with open(filename) as f:
    username = json.load(f)
    print(f"Приветствую {username} !")
```

```python
filename = 'rec.txt'

with open(filename, 'a') as file_object: # Открываем фаил в режиме чтения-записи
                                         # w-запись, r-чтение, a-чтение и запись 
                                         # r+ - чтение и запись в файл
                                         # write - метод записи строки в файл
    file_object.write("Текст добавляется в конец файла.") 
    file_object.write("\nТак, нужно добавлять пернос строки.") 

with open(filename) as file_object:
    object = file_object.read() 
    print(object)
```
#### - Программа загружает имя пользователя, если оно было сохранено раннее. В противном случае она записывает имя пользователя и сохраняет его. -

```python
filename = 'username.json'

try:
    with open(filename) as f:
        username =json.load(f)
except FileNotFoundError:
    username = input(" Имя :")
    with open(filename, 'w') as f:
        json.dump(username, f)
        print(f"Имя {username} успешно сохранено в json файл")
else:
    print(f"Добро пожаловать, {username}!")
```

#### -  Рефакторинг - запаковываем код в функцию -

```python
def get_stored_username():
    """Приветствует пользователя по имени"""
    filename = 'username.json'
    try:
        with open(filename) as f:
            username =json.load(f)
    except FileNotFoundError:
        return None 
    else:
        return username

def greet_user():
    """Приветствует пользователя по имени"""
    username = get_stored_username()
    if username:
        print(f"Приветствую, {username}")
    else:
        username = input("Имя: ")
        filename = 'username.json'
        with open(filename, w) as f:
            json.dump(username, f)
            print(f"Имя {username} записанно в файл")
greet_user()

```

```python
def get_stored_username():
    """Приветствует пользователя по имени"""
    filename = 'username.json'
    try:
        with open(filename) as f:
            username =json.load(f)
    except FileNotFoundError:
        return None 
    else:
        return username
    
def get_new_username():
    """Запрашивает новое имя пользователя"""
    username = input(" Имя: ")
    filename = 'username.json'
    with open(filename, 'w') as f:
        json.dump(username, f)
    return username

def greet_user():
    """Приветствует пользователя по имени"""
    username = get_stored_username()
    if username:
        print(f"Приветствую, {username}")
    else:
        username = get_new_username()
        print(f"Имя {username} записанно в файл")
greet_user()
```

#### - ИСКЛЮЧЕНИЯ try-except -

```python
try:
    print(5/0)
except ZeroDivisionError: # Указываем как необхдимо действовать в 
                          # случае ошибки ZeroDivisionError
    print("На 0 делить нальзя")
```

#### - Пример с Предотвращение аварийного завершения программы - 

```python
print("Введите числа для деления")
print("Нажмите 'q' для выхода")

while True:
    first_number = input("\n Первое чилсо: ")
    if first_number == 'q':
        break
    second_number = input("Второе число:  ")
    if second_number == 'q': 
        break
    try: # Выполняем код в блоке try
        answer = int(first_number) / int(second_number)
    except ZeroDivisionError: # Если код заканчивается ошибкой, выводим текст:
        print("На НОЛЬ не делиться!")
    else: # Если без ошибко:
        print(answer) # - вы полнем этот код 
```

#### - исключение FileNotFoundError -

```python
filename = 'alice.txt'

try:
    with open(filename, encoding='utf-8') as f:
        contents = f.read()
except FileNotFoundError:
    print(f"Извините, файл {filename} не нйден")    
```

#### - анализ Текста, подсчет слов -

```python
filename = 'alice.txt'

try:
    with open(filename, encoding='utf-8') as f:
        contents = f.read()
except FileNotFoundError:
    print(f"Извините, файл {filename} не нйден")    
else:
    # Подсчет приблизительного количества строк в файле.
    words = contents.split()
    num_worlds = len(words)
    print(f"В файле {filename} - {num_worlds} слов")
```


```python
def count_words(filename):
    """Подсчет приблизительного количества слов в файле."""
    try:
        with open(filename, encoding='utf-8') as f:
            contents = f.read()
    except FileNotFoundError:
        print(f"Извините, файл {filename} не нйден")    
    else:
        # Подсчет приблизительного количества строк в файле.
        words = contents.split() ## метод подсчета слов
        num_worlds = len(words)
        print(f"В файле {filename} - {num_worlds} слов")

filenames = ['alice.txt', 'ring.txt', 'none.txt']
for filename in filenames:
    count_words(filename)
```

#### - Ошибка без уведомления -

```python
def count_words(filename):
    """Подсчет приблизительного количества слов в файле."""
    try:
        with open(filename, encoding='utf-8') as f:
            contents = f.read()
    except FileNotFoundError:
        pass   # НЕ выводим ошибку
    else:
        # Подсчет приблизительного количества строк в файле.
        words = contents.split() ## метод подсчета слов
        num_worlds = len(words)
        print(f"В файле {filename} - {num_worlds} слов")

filenames = ['alice.txt', 'ring.txt', 'none.txt']
for filename in filenames:
    count_words(filename)
```



[Назад](Конспект_Python.md)