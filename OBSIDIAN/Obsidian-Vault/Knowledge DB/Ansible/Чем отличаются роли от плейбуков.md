#ansible

В контексте [[Ansible]], который является одним из популярных инструментов автоматизации IT-инфраструктур, роли и плейбуки представляют собой ключевые компоненты, но они используются для различных целей и имеют разные области применения.

**Плейбуки (Playbooks)**

Это YAML-файлы, которые описывают задачи и процессы автоматизации, которые необходимо выполнить на одной или нескольких управляемых машинах. Они включают в себя одну или несколько "игр" (plays), каждая из которых может целиться на определённую группу хостов для выполнения заданных задач. Плейбук может описывать полную конфигурацию сервера, установку программного обеспечения, обновление системы и другие операционные задачи.

Пример простого плейбука:

````yaml
```yaml
- name: Update web servers
  hosts: webservers
  tasks:
    - name: Ensure nginx is at the latest version
      ansible.builtin.yum:
        name: nginx
        state: latest
```
````

**Роли (Roles)**

Предназначены для более удобной организации и повторного использования кода Ansible. Роль инкапсулирует чётко определённую функциональность, включая переменные, зависимости, файлы конфигурации и шаблоны, что позволяет переиспользовать эту функциональность в различных плейбуках и проектах. Структура роли строго организована, что помогает в её модульности и переносимости.

Стандартная структура роли включает:

- **`tasks/`** — Главные задачи роли.
- **`handlers/`** — Обработчики, которые вызываются по специальным триггерам.
- **`defaults/`** — Стандартные значения переменных, которые использует роль.
- **`vars/`** — Другие переменные, которые могут быть определены в роли.
- **`files/`** — Файлы, которые можно скопировать на управляемые машины.
- **`templates/`** — Шаблоны, которые можно обработать и скопировать на управляемые машины.
- **`meta/`** — Метаданные роли, включая зависимости от других ролей.

Основные отличия

- **Модульность:** Роли предлагают высокий уровень модульности и переиспользования, в то время как плейбуки обычно определяют конкретные процедуры автоматизации для конкретных сценариев.
- **Организация:** Плейбуки могут использовать роли для организации и сокращения количества кода, делая плейбуки более читаемыми и легкими для поддержки.
- **Повторное использование:** Роли могут быть легко переиспользованы в разных проектах и плейбуках, в то время как плейбуки обычно специфичны для проекта.

Плейбуки являются основными файлами, которые вызывают роли и другие задачи для выполнения операций на управляемых машинах. Роли представляют собой модульные блоки, которые организуют код, связанный с определённой функциональностью, и позволяют его переиспользовать в различных плейбуках. Разделение задач и кода между плейбуками и ролями улучшает организацию, облегчает управление и повышает эффективность процесса автоматизации.