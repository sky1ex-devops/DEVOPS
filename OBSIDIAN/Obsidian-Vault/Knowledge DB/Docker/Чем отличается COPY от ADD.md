#docker 

Команды `COPY` и `ADD` - это две инструкции, используемые в Dockerfile для копирования файлов и папок из исходной директории хост-системы в образ [[Docker]]. Они выполняют схожую функцию, но есть несколько ключевых различий:

1. **Функциональность**:
    
    - `COPY`: Команда `COPY` просто копирует файлы и папки из исходной директории на хост-системе в указанное место в образе Docker. Она предназначена для базовой операции копирования файлов.
        
    - `ADD`: Команда `ADD` также копирует файлы и папки из исходной директории, но также может выполнять дополнительные действия, такие как извлечение файлов из архивов (например, `.tar`) и загрузку файлов из URL. Это более мощная команда, которая может выполнять дополнительные операции.
        
2. **Инструкции в Dockerfile**:
    
    - `COPY`: Инструкция `COPY` имеет простой синтаксис и обычно выглядит следующим образом: `COPY <source> <destination>`, где `<source>` - это исходный файл или директория на хост-системе, а `<destination>` - место, куда файлы или папки будут скопированы в образе.
        
    - `ADD`: Инструкция `ADD` также имеет синтаксис `ADD <source> <destination>`, но она добавляет дополнительную функциональность для обработки URL и архивов. Это может быть полезным, например, для автоматической загрузки и разархивирования файлов из интернета.
        
3. **Кеширование**:
    
    - `COPY`: Команда `COPY` более подходит для случаев, когда вы хотите убедиться, что слои образа могут быть легко кешированы, поскольку она выполняет простую операцию копирования файлов. Это может способствовать более быстрой сборке образов при использовании кеширования.
        
    - `ADD`: Инструкция `ADD`, особенно при использовании для извлечения файлов из архивов, может создавать слои образа, которые сложнее кешировать, так как она включает в себя дополнительные шаги, которые могут изменяться со временем (например, URL-загрузки). Это может ухудшить эффективность кеширования.
        

В большинстве случаев для простых операций копирования файлов предпочтительно использовать `COPY`, так как она более предсказуема и эффективна. `ADD` лучше подходит, если вам нужна дополнительная функциональность, такая как извлечение архивов или загрузка файлов из интернета.

-----

Инструкция COPY работатет с локальными файлами и позволяет копировать их в контейнер

Инструкция ADD работает с ссылками, архивами и локальными файлами: позволяет скачивать файлы из интернета аналогично команде wget, распаковывать архивы формата .tar и копировать локальные файлы в контейнер

-----

В Dockerfile две инструкции, позволяющие добавлять файлы из локальной файловой системы в файловую систему Docker образа, это **`COPY`** и **`ADD`**. Хотя на первый взгляд они могут казаться похожими, между ними есть несколько важных отличий, которые определяют выбор в зависимости от ситуации.

Инструкция

**`COPY`** более простая и прямолинейная инструкция, используемая для копирования файлов и каталогов из контекста сборки в файловую систему образа Docker. **`COPY`** принимает исходный путь и путь назначения внутри файловой системы образа. Она строго копирует файлы, сохраняя их точные метаданные, без какой-либо дополнительной интерпретации.

````go
```dockerfile
COPY ./localfile.txt /directory/in/container/localfile.txt
```
````

Инструкция

**`ADD`** обладает всеми возможностями **`COPY`**, но также включает в себя дополнительную функциональность. Также может автоматически распаковывать локальные архивные файлы в целевой каталог образа. Кроме того, она поддерживает загрузку файлов из URL, что делает её более многофункциональной по сравнению с **`COPY`**.

````go
```dockerfile
ADD ./localarchive.tar.gz /directory/in/container/
```
````

И файлы из архива будут автоматически распакованы в указанную директорию.

Основные отличия

**1. Функциональность: `COPY`** просто копирует файлы и папки, в то время как **`ADD`** имеет дополнительные функции, такие как распаковка архивов и возможность загрузки файлов из URL.  
**2. Рекомендации по использованию:** Docker рекомендует использовать **`COPY`**, если не требуется функциональность распаковки архивов или загрузки из сети, так как **`COPY`** более прозрачна и предсказуема.

**`COPY`** и **`ADD`** используются для добавления файлов в образ Docker, но **`COPY`** предпочтительнее для стандартных операций копирования из-за своей простоты и прозрачности. **`ADD`** полезна, когда нужно воспользоваться её дополнительными возможностями, но её использование может привести к менее предсказуемому поведению, особенно при работе с внешними источниками.